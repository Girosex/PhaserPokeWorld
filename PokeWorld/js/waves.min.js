let wavesstate={preload:preloadAssets,create:initWaves,update:updateWaves},magnemite;function preloadAssets(){game.load.image("fondoWaves","assets/imgs/gamePlay.jpg"),game.load.image("enemigo","assets/imgs/snorlax.png"),game.load.image("magneton","assets/imgs/magneton.png"),game.load.image("magnemite","assets/imgs/magnemite.png"),game.load.image("gengar","assets/imgs/gengar.png"),game.load.image("trainer","assets/imgs/entrenador.png"),game.load.image("pokeball","assets/imgs/pokeball.png"),game.load.spritesheet("impact","assets/imgs/impact.png",48,48),game.load.spritesheet("explosion","assets/imgs/Explosion.png",64,64),game.load.text("palabras","json/datalevel.json",!0),game.load.text("waves","json/partA.json",!0),game.load.text("partB","json/partB.json",!0),game.load.audio("pop","assets/audio/pop.mp3"),game.load.audio("splat","assets/audio/splat.mp3"),game.load.audio("pokesound","assets/audio/pokesound.mp3"),game.load.image("atrasWaves","assets/imgs/atrasGameW.png")}function initWaves(){partNumber=2,game.physics.setBoundsToWorld(),fondoWaves=game.add.image(0,-200,"fondoWaves"),fondoWaves.scale.setTo(.8),atrasGame=game.add.button(10,690,"atrasWaves",VolverAtrasDelWave),atrasGame.scale.setTo(.1),game.input.keyboard.addCallbacks(this,null,null,keyPressed),game.time.events.loop(1e3,updateTime,this),tiempo=0,aciertos=0,fallos=0,temporizador=game.add.text(5,5,"Tiempo: "+tiempo),loadLevel(),loadPartB(),createKeyControlls(),createTrainer(),createExplosions(EXPLOSIONS_GROUP_SIZE),createImpacts(IMPACTS_GROUP_SIZE),createPokeballs(),createEnemy(n),createMagneton(n),createGengar(n),currentEnemies=waves[n].amount+wavesB[n].magneton+wavesB[n].gengar,pop=game.add.audio("pop"),splat=game.add.audio("splat"),pokesound=game.add.audio("pokesound")}function createMagneton(number){magneton=game.add.group(),magneton.enableBody=!0,magneton.createMultiple(4,"magneton"),magneton.callAll("events.onOutOfBounds.add","events.onOutOfBounds",resetMember),magneton.callAll("anchor.setTo","anchor",.5,1),magneton.setAll("checkWorldBounds",!0),game.physics.arcade.enable(magneton),createMagnetonWave(number)}function createMagnetonWave(n){for(currentMagneton=wavesB[n].magneton,currentSpecialVelocity=wavesB[n].speed,i=0;i<wavesB[n].magneton;i++)game.time.events.add(Math.floor(Math.random()*waves[n].rate),activateMagneton,this)}function activateMagneton(){let magnet=magneton.getFirstExists(!1),gw=game.world.width,uw=magnet.body.width,w=gw-uw,x,z=uw/2+Math.floor(Math.random()*w);magnet.reset(z,0);let desp=180*Math.random()-90,d=Math.sqrt((game.world.centerX+desp-magnet.x)**2+(game.world.height-100-magnet.y)**2);magnet.body.velocity.x=(game.world.centerX+desp-magnet.x)/d*currentSpecialVelocity,magnet.body.velocity.y=(game.world.height-100-magnet.y)/d*currentSpecialVelocity,magnet.checkWorldBounds=!0,magnet.events.onOutOfBounds.add(pokeOut,this),palabraHijo=magnet.addChild(game.make.text(-30,0,wordsM[1].palabrasM[elegirPalabraM()])),palabrasEnPantalla.push(palabraHijo),magnet.angle=180*Math.atan2(game.world.height-100-magnet.y,game.world.centerX+desp-magnet.x)/Math.PI-90,magnet.game.time.events.add(Math.floor(6e3*Math.random()),dropMagnet,this)}function dropMagnet(){currentEnemies+=1,magnemite=game.add.sprite(200,100,"magnemite"),magnemite.anchor.setTo(.5,.5),game.physics.arcade.enable(magnemite),magnemite.checkWorldBounds=!0,magnemite.events.onOutOfBounds.add(pokeOut,this);let d=Math.sqrt((game.world.centerX-magnemite.x)**2+(game.world.height-100-magnemite.y)**2);magnemite.body.velocity.x=(game.world.centerX-magnemite.x)/d*currentEnemyVelocity,magnemite.body.velocity.y=(game.world.height-100-magnemite.y)/d*currentEnemyVelocity,palabraHijo=magnemite.addChild(game.make.text(-30,0,words[0].palabras[elegirPalabra()])),palabrasEnPantalla.push(palabraHijo),magnemite.angle=180*Math.atan2(game.world.height-100-magnemite.y,game.world.centerX-magnemite.x)/Math.PI-90}function createGengar(number){gengar=game.add.group(),gengar.enableBody=!0,gengar.createMultiple(3,"gengar"),gengar.callAll("events.onOutOfBounds.add","events.onOutOfBounds",resetMember),gengar.callAll("anchor.setTo","anchor",.5,1),gengar.setAll("checkWorldBounds",!0),game.physics.arcade.enable(gengar),createGengarWave(number)}function createGengarWave(n){for(currentGengar=wavesB[n].gengar,currentSpecialVelocity=wavesB[n].speed,i=0;i<wavesB[n].gengar;i++)game.time.events.add(Math.floor(Math.random()*waves[n].rate),activateGengar,this)}function activateGengar(){let geng=gengar.getFirstExists(!1),gw=game.world.width,uw=geng.body.width,w=gw-uw,x,z=uw/2+Math.floor(Math.random()*w);geng.reset(z,0);let desp=180*Math.random()-90,d=Math.sqrt((game.world.centerX+desp-geng.x)**2+(game.world.height-100-geng.y)**2);geng.body.velocity.x=(game.world.centerX+desp-geng.x)/d*currentSpecialVelocity,geng.body.velocity.y=(game.world.height-100-geng.y)/d*currentSpecialVelocity,geng.checkWorldBounds=!0,geng.events.onOutOfBounds.add(pokeOut,this),palabraHijo=geng.addChild(game.make.text(-30,0,wordsM[2].palabrasL[elegirPalabraL()])),palabrasEnPantalla.push(palabraHijo),geng.angle=180*Math.atan2(game.world.height-100-geng.y,game.world.centerX+desp-geng.x)/Math.PI-90}function elegirPalabraM(){for(randomWord=Math.floor(Math.random()*words[1].palabrasM.length),i=0;i<palabrasEnPantalla.length;i++)palabrasEnPantalla[i].text[0]==words[1].palabrasM[randomWord][0]&&elegirPalabra();return randomWord}function elegirPalabraL(){for(randomWord=Math.floor(Math.random()*words[2].palabrasL.length),i=0;i<palabrasEnPantalla.length;i++)palabrasEnPantalla[i].text[0]==words[2].palabrasL[randomWord][0]&&elegirPalabra();return randomWord}function p(pointer){console.log(pointer.event)}function updateWaves(){game.physics.arcade.overlap(trainer,enemy,enemyHitsTrainer,null,this),game.physics.arcade.overlap(trainer,magneton,magnetonHitsTrainer,null,this),game.physics.arcade.overlap(trainer,gengar,gengarHitsTrainer,null,this),game.physics.arcade.overlap(pokeballs,enemy,pokeballHitsPoke,null,this),game.physics.arcade.overlap(pokeballs,magneton,pokeballHitsMagneton,null,this),game.physics.arcade.overlap(pokeballs,gengar,pokeballHitsGengar,null,this),game.physics.arcade.overlap(pokeballs,magnemite,pokeballHitsMagnemite,null,this),trainerMove(),botonAtrasWave()}function pokeballHitsMagneton(){pokeballAire-=1,pokeball.kill(),muerto&&1==pokeballAire&&(explosionPokemon(palabrasEnPantalla[enemigoApuntado].parent),palabrasEnPantalla[enemigoApuntado].parent.kill(),muerto=!1,pop.play(),currentEnemies-=1,0==currentEnemies&&n<3&&game.state.start("stats"))}function pokeballHitsMagnemite(){pokeballAire-=1,pokeball.kill(),muerto&&1==pokeballAire&&(explosionPokemon(palabrasEnPantalla[enemigoApuntado].parent),palabrasEnPantalla[enemigoApuntado].parent.kill(),muerto=!1,pop.play(),currentEnemies-=1,0==currentEnemies&&n<3&&game.state.start("stats"))}function pokeballHitsGengar(){pokeballAire-=1,pokeball.kill(),muerto&&1==pokeballAire&&(explosionPokemon(palabrasEnPantalla[enemigoApuntado].parent),palabrasEnPantalla[enemigoApuntado].parent.kill(),muerto=!1,pop.play(),currentEnemies-=1,0==currentEnemies&&n<3&&game.state.start("stats"))}function magnetonHitsTrainer(trainer,poke){poke.kill(),trainer.kill(),game.time.events.add(2e3,goToGameOver,this),displayImpact(trainer),splat.play()}function gengarHitsTrainer(trainer,poke){poke.kill(),trainer.kill(),game.time.events.add(2e3,goToGameOver,this),displayImpact(trainer),splat.play()}function createKeyControlls(){cursors=game.input.keyboard.createCursorKeys()}function trainerMove(){trainer.body.velocity.x=0,cursors.left.isDown||game.input.speed.x<0?trainer.body.velocity.x=-TRAINER_VELOCITY:(cursors.left.isDown||game.input.speed.x>0)&&(trainer.body.velocity.x=TRAINER_VELOCITY)}function loadPartB(){partBConfig=JSON.parse(game.cache.getText("partB")),configWordsM=JSON.parse(game.cache.getText("palabras")),createPartB(partBConfig),createWordsM(configWordsM)}function createPartB(partBConfig){wavesB=partBConfig.waves}function createWordsM(configWordsM){wordsM=configWordsM.datalevel}function botonAtrasWave(){atrasGame.input.pointerOver()?atrasGame.scale.setTo(.11):atrasGame.scale.setTo(.1)}function VolverAtrasDelWave(){game.state.start("menu")}